{"version":3,"sources":["apiKey.js","page/Taichung/Bus.js","requests.js","index.js"],"names":["getAuthorizationHeader","GMTString","Date","toGMTString","ShaObj","jsSHA","setHMACKey","update","Authorization","getHMAC","Bus","useState","routeInput","setRouteInput","originInput","setOriginInput","destinationInput","setDestinationInput","data","setData","outputData","setOutputData","fetchData","a","reqURL","axios","get","headers","then","res","console","log","catch","err","useEffect","station","map","item","Stops","stopsArray","index","result","TimeTables","timeArray","routeName","RouteName","Zh_tw","id","StopID","stationName","StopName","endStation","DestinationStopName","departTime","ArrivalTime","order","findStation","departStation","find","match","includes","destinationStation","className","type","placeholder","value","onChange","e","target","onClick","preventDefault","alert","TableContainer","Table","TableHead","TableRow","TableCell","align","TableBody","undefined","departItem","idx","ReactDOM","render","StrictMode","document","getElementById"],"mappings":"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","file":"static/js/main.4107c5cb.chunk.js","sourcesContent":["import jsSHA from \"jssha\";\n\nconst getAuthorizationHeader = function () {\n\tconst apiID = \"e076b2463e674e1e95cf5fd189f15b00\";\n\tconst apiKey = \"nL1Irz7_VltcPMn6JTT7VyW-yWI\";\n\n\tvar GMTString = new Date().toGMTString();\n\tvar ShaObj = new jsSHA(\"SHA-1\", \"TEXT\");\n\tShaObj.setHMACKey(apiKey, \"TEXT\");\n\tShaObj.update(\"x-date: \" + GMTString);\n\tvar HMAC = ShaObj.getHMAC(\"B64\");\n\tvar Authorization =\n\t\t'hmac username=\"' +\n\t\tapiID +\n\t\t'\", algorithm=\"hmac-sha1\", headers=\"x-date\", signature=\"' +\n\t\tHMAC +\n\t\t'\"';\n\n\treturn {\n\t\tAuthorization: Authorization,\n\t\t\"X-Date\": GMTString,\n\t};\n};\n\nexport default getAuthorizationHeader;\n","/* eslint-disable no-unused-expressions */\n/* eslint-disable react-hooks/exhaustive-deps */\nimport React, { useState, useEffect } from \"react\";\nimport \"./Bus.css\";\nimport { taichungBus } from \"../../requests\";\nimport getAuthorizationHeader from \"../../apiKey\";\nimport axios from \"axios\";\nimport {\n\tTable,\n\tTableBody,\n\tTableCell,\n\tTableContainer,\n\tTableHead,\n\tTableRow,\n} from \"@material-ui/core\";\n\nfunction Bus() {\n\tconst [routeInput, setRouteInput] = useState(\"\");\n\tconst [originInput, setOriginInput] = useState(\"\");\n\tconst [destinationInput, setDestinationInput] =\n\t\tuseState(\"\");\n\tconst [data, setData] = useState([]);\n\tconst [outputData, setOutputData] = useState();\n\n\tconst fetchData = async () => {\n\t\tconst reqURL = taichungBus(routeInput);\n\t\tawait axios\n\t\t\t.get(reqURL, { headers: getAuthorizationHeader() })\n\t\t\t.then((res) => {\n\t\t\t\tconsole.log(\"raw:\", res.data);\n\t\t\t\tsetData(res.data);\n\t\t\t})\n\t\t\t.catch((err) => console.log(err));\n\t};\n\n\tconst searchBtn = (e) => {\n\t\te.preventDefault();\n\t\tif (\n\t\t\trouteInput &&\n\t\t\toriginInput &&\n\t\t\tdestinationInput !== \"\"\n\t\t) {\n\t\t\tfetchData();\n\t\t} else {\n\t\t\talert(\"請輸入站別或路線\");\n\t\t}\n\t};\n\n\tuseEffect(() => {\n\t\t// rename Object\n\t\tconst station = data.map((item) => {\n\t\t\t// 解 Stops Array\n\t\t\treturn item.Stops.map((stopsArray, index) => {\n\t\t\t\tconst result = stopsArray.TimeTables.map(\n\t\t\t\t\t(timeArray) => {\n\t\t\t\t\t\treturn {\n\t\t\t\t\t\t\trouteName: item.RouteName.Zh_tw,\n\t\t\t\t\t\t\tid: stopsArray.StopID,\n\t\t\t\t\t\t\tstationName: stopsArray.StopName.Zh_tw,\n\t\t\t\t\t\t\tendStation: item.DestinationStopName.Zh_tw,\n\t\t\t\t\t\t\tdepartTime: timeArray.ArrivalTime,\n\t\t\t\t\t\t};\n\t\t\t\t\t}\n\t\t\t\t);\n\t\t\t\treturn {\n\t\t\t\t\torder: index,\n\t\t\t\t\tstationName: stopsArray.StopName.Zh_tw,\n\t\t\t\t\tresult,\n\t\t\t\t};\n\t\t\t});\n\t\t});\n\t\tconsole.log(\"station: \", station);\n\n\t\t//挑出起迄站\n\t\tconst findStation = station.map((item) => {\n\t\t\tconst departStation = item.find((match) =>\n\t\t\t\toriginInput.includes(match.stationName)\n\t\t\t);\n\t\t\tconst destinationStation = item.find((match) =>\n\t\t\t\tdestinationInput.includes(match.stationName)\n\t\t\t);\n\t\t\treturn { departStation, destinationStation };\n\t\t});\n\t\tconsole.log(\"findstation: \", findStation);\n\n\t\tsetOutputData(\n\t\t\tfindStation.find((item) => {\n\t\t\t\treturn (\n\t\t\t\t\titem.departStation.order <\n\t\t\t\t\titem.destinationStation.order\n\t\t\t\t);\n\t\t\t})\n\t\t);\n\t}, [data, setOutputData]);\n\tconsole.log(\"output: \", outputData);\n\n\treturn (\n\t\t<div className=\"bus\">\n\t\t\t<h1>台中公車時刻表查詢</h1>\n\t\t\t<form className=\"bus__searchForm\">\n\t\t\t\t<div className=\"bus__searchContainer\">\n\t\t\t\t\t<input\n\t\t\t\t\t\tclassName=\"bus__routeName\"\n\t\t\t\t\t\ttype=\"text\"\n\t\t\t\t\t\tplaceholder={\"路線\"}\n\t\t\t\t\t\tvalue={routeInput}\n\t\t\t\t\t\tonChange={(e) => setRouteInput(e.target.value)}\n\t\t\t\t\t/>\n\n\t\t\t\t\t<input\n\t\t\t\t\t\tclassName=\"bus__origin\"\n\t\t\t\t\t\ttype=\"text\"\n\t\t\t\t\t\tplaceholder=\"出發站\"\n\t\t\t\t\t\tvalue={originInput}\n\t\t\t\t\t\tonChange={(e) => setOriginInput(e.target.value)}\n\t\t\t\t\t/>\n\n\t\t\t\t\t<input\n\t\t\t\t\t\tclassName=\"bus__destination\"\n\t\t\t\t\t\ttype=\"text\"\n\t\t\t\t\t\tplaceholder=\"抵達站\"\n\t\t\t\t\t\tvalue={destinationInput}\n\t\t\t\t\t\tonChange={(e) =>\n\t\t\t\t\t\t\tsetDestinationInput(e.target.value)\n\t\t\t\t\t\t}\n\t\t\t\t\t/>\n\t\t\t\t\t<button\n\t\t\t\t\t\tclassName=\"bus__searchBtn\"\n\t\t\t\t\t\tonClick={searchBtn}>\n\t\t\t\t\t\tGo\n\t\t\t\t\t</button>\n\t\t\t\t\t<p className=\"bus__userTips\">\n\t\t\t\t\t\t因功能未完善，請完整輸入站牌及路線名稱，ex:\n\t\t\t\t\t\t路線：14副2 、 站牌名： 四張犁(昌平路)\n\t\t\t\t\t</p>\n\t\t\t\t\t<TableContainer>\n\t\t\t\t\t\t<Table aria-label=\"collapsible table\">\n\t\t\t\t\t\t\t<TableHead>\n\t\t\t\t\t\t\t\t<TableRow>\n\t\t\t\t\t\t\t\t\t<TableCell align=\"center\">路線</TableCell>\n\t\t\t\t\t\t\t\t\t<TableCell align=\"center\">\n\t\t\t\t\t\t\t\t\t\t起點站\n\t\t\t\t\t\t\t\t\t</TableCell>\n\t\t\t\t\t\t\t\t\t<TableCell align=\"center\">\n\t\t\t\t\t\t\t\t\t\t發車時間\n\t\t\t\t\t\t\t\t\t</TableCell>\n\t\t\t\t\t\t\t\t\t<TableCell align=\"center\">\n\t\t\t\t\t\t\t\t\t\t目的地\n\t\t\t\t\t\t\t\t\t</TableCell>\n\t\t\t\t\t\t\t\t\t<TableCell align=\"center\">\n\t\t\t\t\t\t\t\t\t\t抵達時間\n\t\t\t\t\t\t\t\t\t</TableCell>\n\t\t\t\t\t\t\t\t\t<TableCell align=\"center\">\n\t\t\t\t\t\t\t\t\t\t終點站\n\t\t\t\t\t\t\t\t\t</TableCell>\n\t\t\t\t\t\t\t\t</TableRow>\n\t\t\t\t\t\t\t</TableHead>\n\t\t\t\t\t\t\t<TableBody>\n\t\t\t\t\t\t\t\t{outputData === undefined ? (\n\t\t\t\t\t\t\t\t\t//防止頁面載入時提前render\n\t\t\t\t\t\t\t\t\t<TableCell align=\"center\"></TableCell>\n\t\t\t\t\t\t\t\t) : (\n\t\t\t\t\t\t\t\t\toutputData.departStation.result.map(\n\t\t\t\t\t\t\t\t\t\t// 利用departStation idex 連帶將 destinationStation 的資料一同 map 出來\n\t\t\t\t\t\t\t\t\t\t(departItem, idx) => (\n\t\t\t\t\t\t\t\t\t\t\t<TableRow>\n\t\t\t\t\t\t\t\t\t\t\t\t<TableCell align=\"center\">\n\t\t\t\t\t\t\t\t\t\t\t\t\t{departItem.routeName}\n\t\t\t\t\t\t\t\t\t\t\t\t</TableCell>\n\t\t\t\t\t\t\t\t\t\t\t\t<TableCell align=\"center\">\n\t\t\t\t\t\t\t\t\t\t\t\t\t{departItem.stationName}\n\t\t\t\t\t\t\t\t\t\t\t\t</TableCell>\n\t\t\t\t\t\t\t\t\t\t\t\t<TableCell align=\"center\">\n\t\t\t\t\t\t\t\t\t\t\t\t\t{departItem.departTime}\n\t\t\t\t\t\t\t\t\t\t\t\t</TableCell>\n\t\t\t\t\t\t\t\t\t\t\t\t<TableCell align=\"center\">\n\t\t\t\t\t\t\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\t\t\t\t\t\t\toutputData.destinationStation\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t.result[idx].stationName\n\t\t\t\t\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t\t\t\t\t</TableCell>\n\t\t\t\t\t\t\t\t\t\t\t\t<TableCell align=\"center\">\n\t\t\t\t\t\t\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\t\t\t\t\t\t\toutputData.destinationStation\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t.result[idx].departTime\n\t\t\t\t\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t\t\t\t\t</TableCell>\n\t\t\t\t\t\t\t\t\t\t\t\t<TableCell align=\"center\">\n\t\t\t\t\t\t\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\t\t\t\t\t\t\toutputData.destinationStation\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t.result[idx].endStation\n\t\t\t\t\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t\t\t\t\t</TableCell>\n\t\t\t\t\t\t\t\t\t\t\t</TableRow>\n\t\t\t\t\t\t\t\t\t\t)\n\t\t\t\t\t\t\t\t\t)\n\t\t\t\t\t\t\t\t)}\n\t\t\t\t\t\t\t</TableBody>\n\t\t\t\t\t\t</Table>\n\t\t\t\t\t</TableContainer>\n\t\t\t\t</div>\n\t\t\t</form>\n\t\t</div>\n\t);\n}\n\nexport default Bus;\n","const trainAPI = (originStation, destination, date) => {\n\treturn `https://ptx.transportdata.tw/MOTC/v3/Rail/TRA/DailyTrainTimetable/OD/${originStation}/to/${destination}/${date}?$format=JSON`;\n};\n\nconst busAPI = (positionLat, positionLon) => {\n\treturn `https://ptx.transportdata.tw/MOTC/v2/Bus/EstimatedTimeOfArrival/NearBy?$select=PlateNumb%2CStopID%2CStopName%2CRouteID%2C%20RouteName%2C%20SubRouteID%2C%20SubRouteName%2C%20Direction%2C%20EstimateTime%2C%20StopStatus%2C%20NextBusTime&$spatialFilter=nearby(${positionLat},${positionLon},500)&$format=JSON`;\n};\n\nconst taichungBus = (routeName) => {\n\treturn `https://ptx.transportdata.tw/MOTC/v2/Bus/DailyStopTimeTable/City/Taichung/${routeName}?$format=JSON`\n\t// return `https://ptx.transportdata.tw/MOTC/v2/Bus/DailyStopTimeTable/City/Taichung/${routeName}?$select=RouteID%2C%20RouteName%2C%20SubRouteName%2C%20DestinationStopID%2C%20DestinationStopName%2CStops&$format=JSON`;\n};\n\nexport { trainAPI, busAPI, taichungBus };\n","import React from \"react\";\nimport ReactDOM from \"react-dom\";\nimport Home from \"./page/Home/Home.js\";\nimport \"./index.css\";\nimport Bus from \"./page/Taichung/Bus.js\";\n\n\n\nReactDOM.render(\n\t<React.StrictMode>\n\t\t{/* <Home /> */}\n\t\t<Bus />\n\t</React.StrictMode>,\n\tdocument.getElementById(\"root\")\n);\n\n// If you want to start measuring performance in your app, pass a function\n// to log results (for example: reportWebVitals(console.log))\n// or send to an analytics endpoint. Learn more: https://bit.ly/CRA-vitals\n"],"sourceRoot":""}